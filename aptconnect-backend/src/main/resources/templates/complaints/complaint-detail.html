<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>민원 상세 정보</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
<div th:if="${currentRole == 'ROLE_MASTER'}">
    <div th:replace="~{/master/navbar :: navbar}"></div>
</div>
<div th:if="${currentRole == 'ROLE_ADMIN'}">
    <div th:replace="~{/admin/navbar :: navbar}"></div>
</div>
<div th:if="${currentRole == 'ROLE_USER'}">
    <div th:replace="~{/register/navbar :: navbar}"></div>
</div>

<div class="container mt-4">
    <h2>민원 상세 정보</h2>

    <div class="card">
        <div class="card-header">
            <h5 th:text="${complaint.title}"></h5>
        </div>
        <div class="card-body">
            <p><strong>카테고리:</strong> <span th:text="${complaint.category}"></span></p>
            <p><strong>내용:</strong></p>
            <p th:text="${complaint.content}"></p>
            <p><strong>작성일:</strong> <span th:text="${#temporals.format(complaint.createdAt, 'yyyy-MM-dd HH:mm')}"></span></p>
            <p><strong>현재 상태:</strong>
                <span class="badge"
                      th:classappend="${complaint.status == 'PENDING' ? 'bg-warning'
                      : (complaint.status == 'IN_PROGRESS' ? 'bg-primary'
                      : 'bg-success')}"
                      th:text="${complaint.status}">
                </span>
            </p>

            <!-- 작성자 정보 (익명이면 표시 안 함) -->
            <div th:if="${!complaint.isAnonymous}">
                <p><strong>작성자:</strong> <span th:text="${complaint.createdBy.name}"></span></p>
            </div>

            <!-- 본인이 작성한 경우 수정/삭제 버튼 표시 -->
            <div th:if="${currentUser.id == complaint.createdBy.id}">
                <a th:href="@{/complaints/edit/{id}(id=${complaint.id})}" class="btn btn-warning">수정</a>
                <a th:href="@{/complaints/delete/{id}(id=${complaint.id})}" class="btn btn-danger"
                   onclick="return confirm('정말 삭제하시겠습니까?');">삭제</a>
            </div>
        </div>
    </div>

    <a href="/complaints" class="btn btn-secondary mt-3">목록으로</a>
</div>
</body>
</html>